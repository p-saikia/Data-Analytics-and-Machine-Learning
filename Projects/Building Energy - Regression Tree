library(rpart) 
library(rpart.plot) 
library(RWeka) 
library(MLmetrics)
rm (list=ls())
cat("\014") 
data <- read.csv('building_energy.csv')
str(data)
summary(data)
train_sample <- sample(768, 576) 
energy_train <- data[train_sample,]
energy_test <- data[-train_sample,]
heating.model <- rpart(Heating.Load ~ Rel..Compactness + Surface.Area + Wall.Area + Roof.Area + Overall.Height + Orientation + Glazing.Area + Glazing.Area.Distribution, data = energy_train) 
cooling.model <- rpart(Cooling.Load ~ Rel..Compactness + Surface.Area + Wall.Area + Roof.Area + Overall.Height + Orientation + Glazing.Area + Glazing.Area.Distribution, data = energy_train)
summary(heating.model)
summary(cooling.model)
rpart.plot(heating.model, digits = 4, fallen.leaves = T, type = 1, extra = 101) 
rpart.plot(cooling.model, digits = 4, fallen.leaves = T, type = 1, extra = 101)
eval.heating <- unname(predict(heating.model, energy_test)) 
eval.cooling <- unname(predict(cooling.model, energy_test)) 
RMSE(eval.heating, energy_test$Heating.Load) 
RMSE(eval.cooling, energy_test$Cooling.Load)
heating.m5p.model <- M5P(Heating.Load ~ Rel..Compactness + Surface.Area + Wall.Area + Roof.Area + Overall.Height + Orientation + Glazing.Area + Glazing.Area.Distribution, data = energy_train) 
cooling.m5p.model <- M5P(Cooling.Load ~ Rel..Compactness + Surface.Area + Wall.Area + Roof.Area + Overall.Height + Orientation + Glazing.Area + Glazing.Area.Distribution, data = energy_train) 
eval.m5p.heating <- unname(predict(heating.m5p.model, energy_test)) 
eval.m5p.cooling <- unname(predict(cooling.m5p.model, energy_test)) 
summary(heating.m5p.model) 
summary(cooling.m5p.model) 
RMSE(eval.m5p.heating, energy_test$Heating.Load) 
RMSE(eval.m5p.cooling, energy_test$Cooling.Load)
