rm (list=ls())
cat("\014") 
library(C50)
library(lattice)
library(ggplot2)
library(caret)
data <- read.csv('bridge.csv')
str(data)
summary(data)
data$addbudget <- ifelse(data$TOTAL_IMP_COST_096 > median(data$TOTAL_IMP_COST_096), "OB", "NOB")
train_sample <- createDataPartition(y=data$addbudget, p=0.9, list = FALSE)
bridge_train <- data[train_sample,]
bridge_test <- data[-train_sample,]
bridge_model <- C5.0(bridge_train[-c(1, 2, 22, 23)], as.factor(bridge_train$addbudget))
summary(bridge_model)
plot(bridge_model)
bridge_pred <- predict(bridge_model, bridge_test)
confusionMatrix(as.factor(bridge_pred), as.factor(bridge_test$addbudget), positive = "NOB")
bridge_model_boost <- C5.0(bridge_train[-c(1, 2, 22, 23)], as.factor(bridge_train$addbudget), trials=10)
summary(bridge_model_boost)
plot(bridge_model_boost)
bridge_pred_boost <- predict(bridge_model_boost, bridge_test)
confusionMatrix(as.factor(bridge_pred_boost), as.factor(bridge_test$addbudget), positive = "NOB")
